!function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=12)}([function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"c",function(){return n}),r.d(e,"a",function(){return o});var i,n,o=function(){function t(){}return t.registerWebGLContext=function(t){i=t},t.registerWebGLRenderer=function(t){n=t},t}()},function(t,e,r){"use strict";r.d(e,"g",function(){return i}),r.d(e,"f",function(){return n}),r.d(e,"i",function(){return o}),r.d(e,"e",function(){return s}),r.d(e,"h",function(){return a}),r.d(e,"a",function(){return h}),r.d(e,"c",function(){return u}),r.d(e,"d",function(){return c}),r.d(e,"b",function(){return f});var i;!function(t){t[t.Repeat=0]="Repeat",t[t.ClampToEdge=1]="ClampToEdge",t[t.MirrorRepeat=2]="MirrorRepeat"}(i||(i={}));var n;!function(t){t[t.Nearest=0]="Nearest",t[t.Linear=1]="Linear"}(n||(n={}));var o;!function(t){t[t.Pos2Tex2=0]="Pos2Tex2",t[t.Pos3Tex2=1]="Pos3Tex2",t[t.Pos3Tex2Nor3=2]="Pos3Tex2Nor3",t[t.Pos3Tex2Col4=3]="Pos3Tex2Col4"}(o||(o={}));var s;!function(t){t[t.Byte=0]="Byte",t[t.Short=1]="Short",t[t.Int=2]="Int"}(s||(s={}));var a;!function(t){t[t.vaCoord=0]="vaCoord",t[t.vaNormal=1]="vaNormal",t[t.vaTexCoord0=2]="vaTexCoord0",t[t.vaTexCoord1=3]="vaTexCoord1",t[t.vaColor=4]="vaColor"}(a||(a={}));var h;!function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Additive=2]="Additive",t[t.Multiply=3]="Multiply",t[t.Screen=4]="Screen"}(h||(h={}));var u;!function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Front=2]="Front"}(u||(u={}));var c;!function(t){t[t.Never=0]="Never",t[t.Less=1]="Less",t[t.Equal=2]="Equal",t[t.LessOrEqual=3]="LessOrEqual",t[t.Greater=4]="Greater",t[t.NotEqual=5]="NotEqual",t[t.GreaterOrEqual=6]="GreaterOrEqual",t[t.Always=7]="Always"}(c||(c={}));var f;!function(t){t[t.All=0]="All",t[t.Color=1]="Color",t[t.Depth=2]="Depth"}(f||(f={}))},function(t,e,r){"use strict";function i(t){return 0==(t&t-1)}function n(t,e){return Math.abs(t-e)<o.eps}r.d(e,"a",function(){return o}),e.c=i,e.b=n;var o={pi:3.1415,deg2rad:3.1415/180,rad2deg:180/3.1415,eps:1e-5}},function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o});var i=r(2),n=function(){function t(t,e,r){this.x=t,this.y=e,this.z=r}return t.prototype.multiplyNum=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.multiplyNumSelf=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.set=function(t,e,r){return this.x=t,this.y=e,this.z=r,this},t.prototype.length=function(){return Math.sqrt(this.lengthQ())},t.prototype.lengthQ=function(){return Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.addToSelf=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.normal=function(){var e=this.length();return e<i.a.eps?new t(0,0,0):this.multiplyNum(1/e)},t.prototype.normalize=function(){var t=this.length();return t<i.a.eps?this.set(0,0,0):this.multiplyNumSelf(1/t),this},t.prototype.lerp=function(t,e){return t.subtract(this).multiplyNum(e).add(this)},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.prototype.negateVector=function(){return new t(-this.x,-this.y,-this.z)},t}(),o=new n(0,0,1)},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var i=function(){function t(t,e,r,i){this.x=t,this.y=e,this.w=r,this.z=i}return t.prototype.set=function(t,e,r,i){this.x=t,this.y=e,this.z=i,this.w=r},t.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var i=r(2),n=function(){function t(t,e){this.x=t,this.y=e}return t.fromVector3=function(e){return new t(e.x,e.y)},t.prototype.set=function(t,e){this.x=t,this.y=e},t.prototype.equalTo=function(t){return Object(i.b)(this.x,t.x)&&Object(i.b)(this.y,t.y)},t.prototype.toAngle=function(){return Math.atan2(this.y,this.x)*i.a.rad2deg},t.prototype.lengthQ=function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},t.prototype.length=function(){return Math.sqrt(this.lengthQ())},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.addToSelf=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.subtractFromSelf=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiply=function(e){return new t(this.x*e,this.y*e)},t.prototype.normal=function(){var e=this.length();return e<i.a.eps?new t(0,0):this.multiply(1/e)},t.prototype.toString=function(){return"x: "+this.x+", y:"+this.y},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var i=r(2),n=r(3),o=function(){function t(){this.e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return t.fromVectorAngle=function(e,r){var i=Math.sin(e),n=Math.cos(e),o=1-n,s=r.x*r.y,a=r.y*r.z,h=r.z*r.x,u=r.x*i,c=r.y*i,f=r.z*i,p=o*s,d=o*a,l=o*h,b=new t;return b.e=[o*r.x*r.x+n,p+f,l-c,0,p-f,o*r.y*r.y+n,d+u,0,l+c,d-u,o*r.z*r.z+n,0,0,0,0,1],b},t.prototype.multiplyMat=function(e){var r=new t,i=this,n=e;return r.e=[i.e[0]*n.e[0]+i.e[4]*n.e[1]+i.e[8]*n.e[2]+i.e[12]*n.e[3],i.e[1]*n.e[0]+i.e[5]*n.e[1]+i.e[9]*n.e[2]+i.e[13]*n.e[3],i.e[2]*n.e[0]+i.e[6]*n.e[1]+i.e[10]*n.e[2]+i.e[14]*n.e[3],i.e[3]*n.e[0]+i.e[7]*n.e[1]+i.e[11]*n.e[2]+i.e[15]*n.e[3],i.e[0]*n.e[4]+i.e[4]*n.e[5]+i.e[8]*n.e[6]+i.e[12]*n.e[7],i.e[1]*n.e[4]+i.e[5]*n.e[5]+i.e[9]*n.e[6]+i.e[13]*n.e[7],i.e[2]*n.e[4]+i.e[6]*n.e[5]+i.e[10]*n.e[6]+i.e[14]*n.e[7],i.e[3]*n.e[4]+i.e[7]*n.e[5]+i.e[11]*n.e[6]+i.e[15]*n.e[7],i.e[0]*n.e[8]+i.e[4]*n.e[9]+i.e[8]*n.e[10]+i.e[12]*n.e[11],i.e[1]*n.e[8]+i.e[5]*n.e[9]+i.e[9]*n.e[10]+i.e[13]*n.e[11],i.e[2]*n.e[8]+i.e[6]*n.e[9]+i.e[10]*n.e[10]+i.e[14]*n.e[11],i.e[3]*n.e[8]+i.e[7]*n.e[9]+i.e[11]*n.e[10]+i.e[15]*n.e[11],i.e[0]*n.e[12]+i.e[4]*n.e[13]+i.e[8]*n.e[14]+i.e[12]*n.e[15],i.e[1]*n.e[12]+i.e[5]*n.e[13]+i.e[9]*n.e[14]+i.e[13]*n.e[15],i.e[2]*n.e[12]+i.e[6]*n.e[13]+i.e[10]*n.e[14]+i.e[14]*n.e[15],i.e[3]*n.e[12]+i.e[7]*n.e[13]+i.e[11]*n.e[14]+i.e[15]*n.e[15]],r},t.prototype.multiplyMatSelf=function(t){return this.e=this.multiplyMat(t).e,this},t.prototype.multiplyVec=function(t){return new n.b(this.e[0]*t.x+this.e[4]*t.y+this.e[8]*t.z+this.e[12],this.e[1]*t.x+this.e[5]*t.y+this.e[9]*t.z+this.e[13],this.e[2]*t.x+this.e[6]*t.y+this.e[10]*t.z+this.e[14])},t.prototype.multiplyNum=function(e){for(var r=new t,i=0;i<16;++i)r.e[i]=this.e[i]*e;return r},t.prototype.identity=function(){this.e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.prototype.ortho=function(t,e,r,i,n,o){this.e=[2/(e-t),0,0,0,0,2/(i-r),0,0,0,0,-2/(o-n),0,-(e+t)/(e-t),-(i+r)/(i-r),-(o+n)/(o-n),1]},t.prototype.perspective=function(t,e,r,n){t=Math.min(179.9,Math.max(0,t));var o=r*Math.tan(t*i.a.deg2rad*.5),s=o*e;this.frustum(-s,s,-o,o,r,n)},t.prototype.frustum=function(t,e,r,i,n,o){this.e=[2*n/(e-t),0,0,0,0,2*n/(i-r),0,0,(e+t)/(e-t),(i+r)/(i-r),(o+n)/(n-o),-1,0,0,2*o*n/(n-o),0]},t.prototype.transpose=function(){for(var e=new t,r=0;r<4;++r)for(var i=0;i<4;++i)e.e[4*r+i]=this.e[4*i+r];return e},t.prototype.rotate=function(e,r){var i=t.fromVectorAngle(e,r);this.multiplyMatSelf(i)},Object.defineProperty(t.prototype,"position",{get:function(){return new n.b(this.e[12],this.e[13],this.e[14])},set:function(t){this.e[12]=t.x,this.e[13]=t.y,this.e[14]=t.z},enumerable:!0,configurable:!0}),t}()},function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"c",function(){return s}),r.d(e,"a",function(){return h});var i,n=r(0),o=r(1);!function(t){t[t.Vertex=0]="Vertex",t[t.Fragment=1]="Fragment"}(i||(i={}));var s;!function(t){t[t.Vec1=0]="Vec1",t[t.Vec2=1]="Vec2",t[t.Vec3=2]="Vec3",t[t.Vec4=3]="Vec4",t[t.Mat4=4]="Mat4",t[t.Sampler=5]="Sampler",t[t.Int=6]="Int"}(s||(s={}));var a=function(){function t(t,e,r,i,n){this.type=t,this.name=e,this.count=r,this.index=i,this.data=n}return t}(),h=function(){function t(){if(this.shaders=[],this.uniforms=[],this.program=n.b.createProgram(),!this.program)return void console.error("ShaderProgram create failed")}return t.unbind=function(){n.b.useProgram(null)},t.prototype.free=function(){n.b.deleteProgram(this.program),this.shaders.forEach(function(t){n.b.deleteShader(t)})},t.prototype.bind=function(){n.b.useProgram(this.program);for(var t=0;t<this.uniforms.length;++t)this.uniforms[t].data&&this.setUniform(t)},t.prototype.attach=function(t,e){var r=this.getWebGLShaderType(t),s=n.b.createShader(r);if(!s)return void console.log("ShaderProgram.attach() failed - can't create shader with type "+r+" ("+t+")");if(this.shaders.push(s),n.b.shaderSource(s,e),n.b.compileShader(s),!n.b.getShaderParameter(s,n.b.COMPILE_STATUS)){console.log("ShaderProgram.attach() failed - can't compile "+t+" shader\n       InfoLog:");var a=n.b.getShaderInfoLog(s);return void console.log(a)}if(t===i.Vertex){var h=Object.keys(o.h).filter(function(t){return"number"==typeof o.h[t]});for(var u in h)n.b.bindAttribLocation(this.program,parseInt(u),o.h[u])}n.b.attachShader(this.program,s)},t.prototype.link=function(){var t=this;if(n.b.linkProgram(this.program),!n.b.getProgramParameter(this.program,n.b.LINK_STATUS)){console.log("ShaderProgram.link() failed at link\n        InfoLog:");var e=n.b.getProgramInfoLog(this.program);console.log(e)}if(n.b.validateProgram(this.program),!n.b.getProgramParameter(this.program,n.b.VALIDATE_STATUS)){console.log("ShaderProgram.link() failed at validate\n        InfoLog:");var e=n.b.getProgramInfoLog(this.program);console.log(e)}this.addUniform(s.Mat4,1,"uModelViewProj",n.c.renderParams.modelViewProjection.e),this.addUniform(s.Vec4,1,"uColor",n.c.renderParams.color.asArray()),this.shaders.forEach(function(e){return n.b.detachShader(t.program,e)})},t.prototype.addUniform=function(t,e,r,i){void 0===i&&(i=null);var o=n.b.getUniformLocation(this.program,r);if(!o)return console.log("ShaderProgram.addUniform failed - gl.getUniformLocation for "+r+" returned null (not found)"),null;var s=new a(t,r,e,o,i);return this.uniforms.push(s)},t.prototype.getUniformIndexByName=function(t){return this.uniforms.filter(function(e){return e.name===t})[0].index||null},t.prototype.setUniform=function(t,e){var r=this.uniforms[t];switch(e&&(r.data=e),r.type){case s.Vec1:n.b.uniform1fv(r.index,r.data);break;case s.Vec2:n.b.uniform2fv(r.index,r.data);break;case s.Vec3:n.b.uniform3fv(r.index,r.data);break;case s.Vec4:n.b.uniform4fv(r.index,r.data);break;case s.Mat4:n.b.uniformMatrix4fv(r.index,!1,r.data);break;case s.Sampler:case s.Int:n.b.uniform1iv(r.index,r.data)}},t.prototype.updateUniformValue=function(t,e){for(var r=-1,i=0;i<this.uniforms.length;++i)if(this.uniforms[i].name===t){r=i;break}if(-1===r)return void console.error("Uniform of name '"+t+"' was not found");this.uniforms[r].data=e},t.prototype.getWebGLShaderType=function(t){switch(t){case i.Vertex:return n.b.VERTEX_SHADER;case i.Fragment:return n.b.FRAGMENT_SHADER;default:return console.log("Unknown ShaderType: "+t+" at ShaderProgram.getWebGLShaderType()"),0}},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var i=r(0),n=r(1),o=function(){function t(e,r){if(this.format=e,this.count=r,this.buffer=i.b.createBuffer(),!this.buffer)return void console.log("Error while creating Index Buffer");this.bind(),i.b.bufferData(i.b.ELEMENT_ARRAY_BUFFER,r*t.getSizeFromFormat(e),i.b.STATIC_DRAW)}return t.getSizeFromFormat=function(t){switch(t){case n.e.Byte:return 1;case n.e.Short:return 2;case n.e.Int:return 4}},t.getWebGLFormat=function(t){switch(t){case n.e.Byte:return i.b.UNSIGNED_BYTE;case n.e.Short:return i.b.UNSIGNED_SHORT;case n.e.Int:return i.b.UNSIGNED_INT}},t.prototype.free=function(){i.b.deleteBuffer(this.buffer)},t.prototype.bind=function(){i.b.bindBuffer(i.b.ELEMENT_ARRAY_BUFFER,this.buffer)},t.prototype.update=function(t,e){this.bind();var r;switch(this.format){case n.e.Byte:r=new Uint8Array(t);break;case n.e.Short:r=new Uint16Array(t);break;case n.e.Int:r=new Uint32Array(t);break;default:return void console.log("IndexBuffer.update() - wrong format: "+this.format)}i.b.bufferSubData(i.b.ELEMENT_ARRAY_BUFFER,e,r)},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var i=r(0),n=r(1),o=function(){function t(t,e){if(this.format=t,this.count=e,this.buffer=i.b.createBuffer(),!this.buffer)return void console.log("Error while creating Vertex Buffer");this.bind();var r=e*this.getSizeFromFormat(this.format);i.b.bufferData(i.b.ARRAY_BUFFER,r,i.b.STATIC_DRAW)}return t.prototype.bind=function(){i.b.bindBuffer(i.b.ARRAY_BUFFER,this.buffer);var t=this.getSizeFromFormat(this.format);switch(this.format){case n.i.Pos3Tex2:i.b.enableVertexAttribArray(n.h.vaCoord),i.b.enableVertexAttribArray(n.h.vaTexCoord0),i.b.vertexAttribPointer(n.h.vaCoord,3,i.b.FLOAT,!1,t,0),i.b.vertexAttribPointer(n.h.vaTexCoord0,2,i.b.FLOAT,!1,t,12);break;case n.i.Pos2Tex2:i.b.enableVertexAttribArray(n.h.vaCoord),i.b.enableVertexAttribArray(n.h.vaTexCoord0),i.b.vertexAttribPointer(n.h.vaCoord,2,i.b.FLOAT,!1,t,0),i.b.vertexAttribPointer(n.h.vaTexCoord0,2,i.b.FLOAT,!1,t,8);break;case n.i.Pos3Tex2Nor3:i.b.enableVertexAttribArray(n.h.vaCoord),i.b.enableVertexAttribArray(n.h.vaTexCoord0),i.b.enableVertexAttribArray(n.h.vaNormal),i.b.vertexAttribPointer(n.h.vaCoord,3,i.b.FLOAT,!1,t,0),i.b.vertexAttribPointer(n.h.vaTexCoord0,2,i.b.FLOAT,!1,t,12),i.b.vertexAttribPointer(n.h.vaNormal,3,i.b.FLOAT,!1,t,20);break;case n.i.Pos3Tex2Col4:i.b.enableVertexAttribArray(n.h.vaCoord),i.b.enableVertexAttribArray(n.h.vaTexCoord0),i.b.enableVertexAttribArray(n.h.vaColor),i.b.vertexAttribPointer(n.h.vaCoord,3,i.b.FLOAT,!1,t,0),i.b.vertexAttribPointer(n.h.vaTexCoord0,2,i.b.FLOAT,!1,t,12),i.b.vertexAttribPointer(n.h.vaColor,4,i.b.FLOAT,!1,t,20)}},t.prototype.free=function(){i.b.deleteBuffer(this.buffer)},t.prototype.update=function(t,e){this.bind(),i.b.bufferSubData(i.b.ARRAY_BUFFER,e,new Float32Array(t))},t.prototype.getSizeFromFormat=function(t){switch(t){case n.i.Pos3Tex2:return 20;case n.i.Pos2Tex2:return 16;case n.i.Pos3Tex2Nor3:return 32;case n.i.Pos3Tex2Col4:return 36}},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return u});var i=r(2),n=r(5),o=r(3),s=r(4),a=r(11),h=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),u=function(t){function e(e,r,i){var o=t.call(this)||this;return o.vertices=new Array(36),o._rotation=0,o._textureRegion=null,o._width=e||1,o._height=r||1,o._pivotPoint=i||new n.a(.5,.5),o.setDefaultVertices(),o.setDefaultTexCoords(),o.setVerticesColor(new s.a(1,1,1,1)),o}return h(e,t),e.getVerticesSize=function(){return 36},e.prototype.free=function(){t.prototype.free.call(this)},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){Object(i.b)(this._rotation,t)||(this.matrix.identity(),this.matrix.rotate(t*i.a.deg2rad,o.a),this._rotation=t,this._rotation>360?this._rotation-=360:this._rotation<-360&&(this._rotation+=360))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){Object(i.b)(this._width,t)||(this._width=t,this.setDefaultVertices())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){Object(i.b)(this._height,t)||(this._height=t,this.setDefaultVertices())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.equalTo(t)||(this._pivotPoint.set(t.x,t.y),this.setDefaultVertices())},enumerable:!0,configurable:!0}),e.prototype.setDefaultVertices=function(){this.vertices[0]=(1-this.pivotPoint.x)*this._width,this.vertices[1]=(1-this.pivotPoint.y)*this._height,this.vertices[2]=0,this.vertices[9]=(1-this.pivotPoint.x)*this._width,this.vertices[10]=(0-this.pivotPoint.y)*this._height,this.vertices[11]=0,this.vertices[18]=(0-this.pivotPoint.x)*this._width,this.vertices[19]=(0-this.pivotPoint.y)*this._height,this.vertices[20]=0,this.vertices[27]=(0-this.pivotPoint.x)*this._width,this.vertices[28]=(1-this.pivotPoint.y)*this._height,this.vertices[29]=0},e.prototype.setDefaultTexCoords=function(){this.vertices[3]=1,this.vertices[4]=1,this.vertices[12]=1,this.vertices[13]=0,this.vertices[21]=0,this.vertices[22]=0,this.vertices[30]=0,this.vertices[31]=1},e.prototype.setFlippedTexCoords=function(){this.vertices[3]=1,this.vertices[4]=0,this.vertices[12]=1,this.vertices[13]=1,this.vertices[21]=0,this.vertices[22]=1,this.vertices[30]=0,this.vertices[31]=0},e.prototype.setVerticesColor=function(t){for(var e=5;e<33;e+=9)this.vertices[e+0]=t.x,this.vertices[e+1]=t.y,this.vertices[e+2]=t.z,this.vertices[e+3]=t.w},e.prototype.setVerticesAlpha=function(t){this.vertices[8]=t,this.vertices[17]=t,this.vertices[26]=t,this.vertices[35]=t},e.prototype.setSize=function(t,e){Object(i.b)(this._width,t)&&Object(i.b)(this._height,e)||(this._width=t,this._height=e,this.setDefaultVertices())},e.prototype.setSizeFromVector2=function(t){this.setSize(t.x,t.y)},e.prototype.setTextureRegion=function(t,e){void 0===e&&(e=!0),this._textureRegion=t,t.rotated?(this.vertices[3]=t.tx,this.vertices[4]=t.ty+t.th,this.vertices[12]=t.tx+t.tw,this.vertices[13]=t.ty+t.th,this.vertices[21]=t.tx+t.tw,this.vertices[22]=t.ty,this.vertices[30]=t.tx,this.vertices[31]=t.ty,e&&this.setSize(t.th*t.texture.height,t.tw*t.texture.width)):(this.vertices[3]=t.tx+t.tw,this.vertices[4]=t.ty+t.th,this.vertices[12]=t.tx+t.tw,this.vertices[13]=t.ty,this.vertices[21]=t.tx,this.vertices[22]=t.ty,this.vertices[30]=t.tx,this.vertices[31]=t.ty+t.th,e&&this.setSize(t.tw*t.texture.width,t.th*t.texture.height))},e.prototype.getTextureRegion=function(){return this._textureRegion},e.prototype.getVerticesWithAbsoluteMatrix=function(){for(var t=this.absoluteMatrix,e=[new o.b(this.vertices[0],this.vertices[1],this.vertices[2]),new o.b(this.vertices[9],this.vertices[10],this.vertices[11]),new o.b(this.vertices[18],this.vertices[19],this.vertices[20]),new o.b(this.vertices[27],this.vertices[28],this.vertices[29])],r=0;r<e.length;++r)e[r]=t.multiplyVec(e[r]);var i=this.vertices.slice();return i[0]=e[0].x,i[1]=e[0].y,i[2]=e[0].z,i[9]=e[1].x,i[10]=e[1].y,i[11]=e[1].z,i[18]=e[2].x,i[19]=e[2].y,i[20]=e[2].z,i[27]=e[3].x,i[28]=e[3].y,i[29]=e[3].z,i},e.prototype.renderSelf=function(){},e}(a.a)},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var i=r(6),n=r(3),o=r(0),s=function(){function t(){this.matrix=new i.a,this.position=new n.b(0,0,0),this.visible=!0,this._dir=new n.b(0,0,0),this._right=new n.b(0,0,0),this._up=new n.b(0,0,0),this._parent=null,this._absoluteMatrix=new i.a,this.matrix.identity(),this.parent=null,this.updateVectorsFromMatrix()}return Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent!==t&&(this._parent=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"up",{get:function(){return this._up},set:function(t){if(t!==this._up){t.normalize();var e=t.cross(this._dir).negate().normalize(),r=e.cross(this._up).normalize();this.updateModelMatrix(r,t,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._dir},set:function(t){if(t!==this._dir){t.normalize();var e=this._up.cross(t).negate().normalize(),r=t.cross(e).normalize();this.updateModelMatrix(t,r,e)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._right},set:function(t){if(t!==this._right){t.normalize();var e=t.cross(this._up).normalize(),r=e.cross(t).normalize();this.updateModelMatrix(e,r,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"absoluteMatrix",{get:function(){return this.matrix.position=this.position,this._absoluteMatrix=null===this._parent?this.matrix:this._parent.absoluteMatrix.multiplyMat(this.matrix),this._absoluteMatrix},set:function(t){this._absoluteMatrix=t},enumerable:!0,configurable:!0}),t.prototype.free=function(){},t.prototype.renderSelf=function(){o.c.renderParams.model=this.absoluteMatrix,o.c.renderParams.calculateMVP(),this.updateVectorsFromMatrix(),this.visible&&this.doRender()},t.prototype.updateModelMatrix=function(t,e,r){this.matrix.e=[r.x,e.x,t.x,0,r.y,e.y,t.y,0,r.z,e.z,t.z,0,this.position.dot(r),this.position.dot(e),this.position.dot(t)],this._dir=t,this._up=e,this._right=r},t.prototype.updateVectorsFromMatrix=function(){this._right.set(this.matrix.e[0],this.matrix.e[4],this.matrix.e[8]),this._up.set(this.matrix.e[1],this.matrix.e[5],this.matrix.e[9]),this._dir.set(this.matrix.e[2],this.matrix.e[6],this.matrix.e[10])},t.prototype.doRender=function(){},t}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(13),n=document.getElementById("canvas-main");if(n){new i.a(n).run()}},function(t,e,r){"use strict";r.d(e,"a",function(){return f});var i=r(14),n=r(7),o=r(15),s=r(16),a=r(10),h=r(17),u=r(20),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),f=function(t){function e(e){var r=t.call(this,e)||this;return r.canvasElement=e,r.vertexShader="\n  attribute vec3 vaCoord;\n  attribute vec2 vaTexCoord0;\n  attribute vec4 vaColor;\n  varying vec2 texCoord0;\n  varying vec4 vColor;\n  uniform mat4 uModelViewProj;\n\n  void main(void)\n  {\n    texCoord0 = vaTexCoord0;\n    vColor = vaColor;\n    gl_Position = uModelViewProj * vec4(vaCoord, 1.0);\n  }\n  ",r.fragmentShader="\n  varying highp vec2 texCoord0;\n  varying highp vec4 vColor;\n  uniform sampler2D uDiffuse;\n  uniform highp vec4 uColor;\n\n  void main(void)\n  {\n    gl_FragColor = uColor * vColor * texture2D( uDiffuse, texCoord0 );\n    if (gl_FragColor.a < 0.001)\n      discard;\n  }\n  ",r._sprites=[],r}return c(e,t),e.prototype.onInit=function(){var t=this;this.renderer.setClearColorRGB(.1,.2,.2,.5),this._shader=new n.a,this._shader.attach(n.b.Vertex,this.vertexShader),this._shader.attach(n.b.Fragment,this.fragmentShader),this._shader.link(),this._material=new i.a(this._shader),(new u.a).load(["assets/atlas.png","assets/atlas.atlas"]).then(function(e){t._texture=e;var r=t._texture.getRegion("lander.png");t._material.addTexture(t._texture,"uDiffuse");for(var i=0;i<300;++i){var n=new a.a(30,30);n.setTextureRegion(r),n.rotation=360*Math.random(),n.position.set(t.renderer.width*Math.random(),t.renderer.height*Math.random(),1),t._sprites.push(n)}}),this._spriteBatch=new o.a,this._camera=new s.a},e.prototype.onUpdate=function(t){for(var e=0,r=this._sprites;e<r.length;e++){r[e].rotation+=10*t}},e.prototype.onRender=function(){t.prototype.onRender.call(this),this._camera.update(),this._shader.updateUniformValue("uModelViewProj",this.renderer.renderParams.modelViewProjection.e),this._shader.updateUniformValue("uColor",[1,1,1,1]),this._material.bind(),this._spriteBatch.start(),this._spriteBatch.drawArray(this._sprites),this._spriteBatch.finish()},e.prototype.onMouseMove=function(t){},e.prototype.onMouseDown=function(t){this.pauseAll=!this.pauseAll},e}(h.a)},function(t,e,r){"use strict";r.d(e,"a",function(){return h});var i=r(4),n=r(7),o=r(0),s=r(1),a=function(){function t(t,e,r){this.texture=t,this.uniformName=e,this.shaderInternalIndex=r}return t}(),h=function(){function t(t){this.shader=t,this.textures=[],this.color=new i.a(1,1,1,1),this.blend=s.a.Alpha,this.depthWrite=!0,this.depthTest=!0,this.depthTestFunc=s.d.Less,this.cull=s.c.Back}return t.prototype.free=function(){},t.prototype.addTexture=function(t,e){var r=this.shader.addUniform(n.c.Sampler,1,e,this.textures.length);if(null===r)return void console.error("Material.addTexture() failed - can't determine shader index for '"+e+"'");this.textures.push(new a(t,e,r))},t.prototype.bind=function(){o.c.setBlendingMode(this.blend),o.c.setCullMode(this.cull),o.c.setDepthWrite(this.depthWrite),o.c.setDepthTest(this.depthTest),o.c.setDepthFunc(this.depthTestFunc),o.c.renderParams.color=this.color,this.textures.forEach(function(t,e){t.texture.bind(e)}),this.shader.bind()},t.prototype.unbind=function(){n.a.unbind()},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var i=r(8),n=r(9),o=r(0),s=r(1),a=r(10),h=[0,1,2,2,3,0],u=a.a.getVerticesSize(),c=function(){function t(){this._count=0,this._vertexData=new Array(65536),this._indexData=new Array(65536),this._vertexBuffer=new n.a(s.i.Pos3Tex2Col4,65536),this._indexBuffer=new i.a(s.e.Short,65536)}return t.prototype.free=function(){this._vertexBuffer.free(),this._indexBuffer.free()},t.prototype.start=function(){this._count=0},t.prototype.finish=function(){0!==this._count&&(this._vertexBuffer.update(this._vertexData,0),this._indexBuffer.update(this._indexData,0),o.c.renderParams.modelViewProjection=o.c.renderParams.viewProjection,o.c.drawTriangles(this._vertexBuffer,this._indexBuffer,0,6*this._count))},t.prototype.drawSingle=function(t){if(t.visible){for(var e=t.getVerticesWithAbsoluteMatrix(),r=0;r<u;++r)this._vertexData[this._count*u+r]=e[r];for(var r=0;r<6;++r)this._indexData[6*this._count+r]=h[r]+4*this._count;++this._count}},t.prototype.drawArray=function(t){var e=this;t.forEach(function(t){return e.drawSingle(t)})},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return f});var i,n=r(6),o=r(5),s=r(3),a=r(0),h=r(11),u=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(t){t[t.Ortho=0]="Ortho",t[t.Perspective=1]="Perspective"}(i||(i={}));var c;!function(t){t[t.TopLeft=0]="TopLeft",t[t.Center=1]="Center",t[t.BottomRight=2]="BottomRight"}(c||(c={}));var f=function(t){function e(){var e=t.call(this)||this;return e.projectionMatrix=new n.a,e._scale=1,e.setProjectionParamsFull(0,0,a.c.width,a.c.height,45,.01,100,i.Ortho,c.TopLeft),e.setViewParams(new s.b(0,0,100),new s.b(0,0,0),new s.b(0,1,0)),e}return u(e,t),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(t){t!==this._scale&&(this._scale=t,this.rebuildProjectionMatrix())},enumerable:!0,configurable:!0}),e.prototype.setProjectionParams=function(t,e,r,i){r=r<0?1:r,i=i<0?1:i,this._x=t,this._y=e,this._width=r,this._height=i,this.rebuildProjectionMatrix()},e.prototype.setProjectionParamsFull=function(t,e,r,i,n,o,s,a,h){this._fov=n,this._zNear=o,this._zFar=s,this._projectionMode=a,this._pivotMode=h,this.setProjectionParams(t,e,r,i)},e.prototype.setViewParams=function(t,e,r){this.matrix.identity(),this._up=r.normal(),this._dir=e.subtract(t).normal(),this._right=this._dir.cross(this._up).normal(),this._up=this._right.cross(this._dir).normal(),this.position=t,this._dir.negate(),this.matrix.e=[this._right.x,this._right.y,this._right.z,this._right.negateVector().dot(this.position),this._up.x,this._up.y,this._up.z,this._up.negateVector().dot(this.position),this._dir.x,this._dir.y,this._dir.z,this._dir.negateVector().dot(this.position),0,0,0,1],this.matrix=this.matrix.transpose(),this.updateVectorsFromMatrix()},e.prototype.translate=function(t,e,r){var i=this._up.multiplyNum(t).add(this._right.multiplyNum(e)).add(this._dir.multiplyNum(r));this.position.addToSelf(i)},e.prototype.rotate=function(t,e){this.matrix.rotate(t,e),this.updateVectorsFromMatrix()},e.prototype.screenToWorld=function(t){if(this._projectionMode===i.Perspective)return console.error("Camera.ScreenToWorld() with perpective camera is not implemented"),new s.b(0,0,0);var e=o.a.fromVector3(this.position).addToSelf(t.multiply(1/this._scale)),r=new o.a(0,0);switch(this._pivotMode){case c.Center:r.set(this._width/(2*this._scale),this._height/(2*this._scale));break;case c.BottomRight:r.set(this._width/this._scale,this._height/this._scale)}return e.subtractFromSelf(r),new s.b(e.x,e.y,0)},e.prototype.renderSelf=function(){},e.prototype.update=function(){this.matrix.position=new s.b(0,0,0),this.matrix.position=this.matrix.multiplyVec(this.position.negateVector()),a.c.renderParams.viewProjection=this.projectionMatrix.multiplyMat(this.matrix),a.c.renderParams.modelViewProjection=a.c.renderParams.viewProjection,this.updateVectorsFromMatrix(),a.c.width===this._width&&a.c.height===this._height||this.setProjectionParams(0,0,a.c.width,a.c.height)},e.prototype.rebuildProjectionMatrix=function(){switch(this.projectionMatrix.identity(),this._projectionMode){case i.Perspective:this.projectionMatrix.perspective(this._fov,this._width/this._height,this._zNear,this._zFar);break;case i.Ortho:var t=2*this._scale;switch(this._pivotMode){case c.TopLeft:this.projectionMatrix.ortho(0,this._width/this._scale,this._height/this._scale,0,this._zNear,this._zFar);break;case c.Center:this.projectionMatrix.ortho(-this._width/t,this._width/t,this._height/t,-this._height/t,this._zNear,this._zFar);break;case c.BottomRight:this.projectionMatrix.ortho(-this._width/t,0,0,-this._height/t,this._zNear,this._zFar)}}},e}(h.a)},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var i=r(18),n=r(1),o=function(){function t(t){var e=this;this.deltaTime=0,this.lastTime=0,this.currentTime=0,this.pauseAll=!1,this.renderer=new i.a(t),this.renderer.onMouseMove=function(t){return e.onMouseMove(t)},this.renderer.onMouseDown=function(t){return e.onMouseDown(t)},this.renderer.setViewPort(0,0,t.width,t.height)}return t.prototype.run=function(){var t=this;this.onInit();var e=function(r){t.lastTime=t.currentTime,t.currentTime=r,t.deltaTime=Math.min(t.currentTime-t.lastTime,.1),t.pauseAll||(t.onUpdate(t.deltaTime),t.onRender()),window.requestAnimationFrame(e)};window.requestAnimationFrame(e)},t.prototype.onRender=function(){this.renderer.clear(n.b.All),this.renderer.resetStates(),this.renderer.resetStatistics()},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var i=r(5),n=r(8),o=r(19),s=r(9),a=r(0),h=r(1),u=8,c=function(){function t(t){this.canvasElement=t,this.renderParams=new o.a,this._blendingMode=h.a.None,this._textureSampler=new Array(u),this._statTextureBind=0,this._statTriCount=0,this._statDIPCount=0;var e=t.getContext("webgl")||t.getContext("experimental-webgl");if(!e)return void console.log("GL initialize failed");a.a.registerWebGLContext(e),a.a.registerWebGLRenderer(this),this.initWebGL(),this.createScreenQuad(),this.initEvents()}return Object.defineProperty(t.prototype,"textureBinds",{get:function(){return this._statTextureBind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"triCount",{get:function(){return this._statTriCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dipCount",{get:function(){return this._statDIPCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.free=function(){this._screenQuadVB.free(),this._screenQuadIB.free()},t.prototype.resize=function(t,e){this.setViewPort(0,0,t,e)},t.prototype.resetStates=function(){this.setCullMode(h.c.Back),this.setBlendingMode(h.a.Alpha),this.setDepthFunc(h.d.LessOrEqual),this.setDepthWrite(!0),this.setDepthTest(!0),this._activeSampler=-1;for(var t=0;t<u;++t)this._textureSampler[t]=null;this._shader=null,this._vertexBuffer=null,this._indexBuffer=null,this._frameBuffer=null,this.renderParams.color.set(1,1,1,1),this.renderParams.viewProjection.identity(),this.renderParams.model.identity()},t.prototype.resetStatistics=function(){this._statDIPCount=0,this._statTextureBind=0,this._statTriCount=0},t.prototype.clear=function(t){switch(t){case h.b.All:a.b.clear(a.b.COLOR_BUFFER_BIT|a.b.DEPTH_BUFFER_BIT);break;case h.b.Color:a.b.clear(a.b.COLOR_BUFFER_BIT);break;case h.b.Depth:a.b.clear(a.b.DEPTH_BUFFER_BIT)}},t.prototype.setClearColorRGB=function(t,e,r,i){a.b.clearColor(t,e,r,i)},t.prototype.setViewPort=function(t,e,r,i){this._width=r,this._height=i,a.b.viewport(t,e,r,i)},t.prototype.setCullMode=function(t){if(t!==this._cullMode){switch(t){case h.c.None:a.b.disable(a.b.CULL_FACE);break;case h.c.Front:a.b.cullFace(a.b.FRONT);break;case h.c.Back:a.b.cullFace(a.b.BACK)}this._cullMode===h.c.None&&a.b.enable(a.b.CULL_FACE),this._cullMode=t}},t.prototype.setBlendingMode=function(t){if(t!==this._blendingMode){switch(t){case h.a.None:a.b.disable(a.b.BLEND);break;case h.a.Alpha:a.b.blendFunc(a.b.SRC_ALPHA,a.b.ONE_MINUS_SRC_ALPHA);break;case h.a.Additive:a.b.blendFunc(a.b.ONE,a.b.ONE);break;case h.a.Multiply:a.b.blendFunc(a.b.DST_COLOR,a.b.ZERO);break;case h.a.Screen:a.b.blendFunc(a.b.ONE,a.b.ONE_MINUS_SRC_COLOR)}this._blendingMode===h.a.None&&a.b.enable(a.b.BLEND),this._blendingMode=t}},t.prototype.setDepthWrite=function(t){t!==this._depthWrite&&(a.b.depthMask(t),this._depthWrite=t)},t.prototype.setDepthTest=function(t){t!==this._depthTest&&(t?a.b.enable(a.b.DEPTH_TEST):a.b.disable(a.b.DEPTH_TEST),this._depthTest=t)},t.prototype.setDepthFunc=function(t){t!==this._depthFunc&&(a.b.depthFunc(this.getWebGLComparison(t)),this._depthFunc=t)},t.prototype.setShader=function(t){t!==this._shader&&(a.b.useProgram(t.program),this._shader=t)},t.prototype.setTexture=function(t,e){this._textureSampler[e]!==t&&(this._activeSampler!==e&&(a.b.activeTexture(a.b.TEXTURE0+e),this._activeSampler=e),a.b.bindTexture(a.b.TEXTURE_2D,null===t?null:t.texture),this._textureSampler[e]=t,++this._statTextureBind)},t.prototype.setVertexBuffer=function(t){if(!t)return void a.b.bindBuffer(a.b.ARRAY_BUFFER,null);t!==this._vertexBuffer&&(t.bind(),this._vertexBuffer=t)},t.prototype.setIndexBuffer=function(t){if(!t)return void a.b.bindBuffer(a.b.ELEMENT_ARRAY_BUFFER,null);t!==this._indexBuffer&&(t.bind(),this._indexBuffer=t)},t.prototype.drawTriangles=function(t,e,r,i){this.setVertexBuffer(t),this.setIndexBuffer(e),a.b.drawElements(a.b.TRIANGLES,i,n.a.getWebGLFormat(e.format),r*n.a.getSizeFromFormat(e.format)),++this._statDIPCount,this._statTriCount+=Math.floor(i/3)},t.prototype.drawScreenQuad=function(t){this.renderParams.viewProjection.ortho(0,1,1,0,-1,1),this.renderParams.modelViewProjection=this.renderParams.viewProjection,t.bind(),this.clear(h.b.All),this.drawTriangles(this._screenQuadVB,this._screenQuadIB,0,6)},t.prototype.initWebGL=function(){var t="\n      Graphics information:\n      Vendor: "+a.b.getParameter(a.b.VENDOR)+"\n      Renderer: "+a.b.getParameter(a.b.RENDERER)+"\n      OpenGL: "+a.b.getParameter(a.b.VERSION)+"\n      GLSL: "+a.b.getParameter(a.b.SHADING_LANGUAGE_VERSION)+"\n      ";console.log(t),a.b.viewport(0,0,this.canvasElement.width,this.canvasElement.height)},t.prototype.initEvents=function(){var t=this,e=new i.a(this.canvasElement.getBoundingClientRect().left,this.canvasElement.getBoundingClientRect().top);new i.a(this.canvasElement.width,this.canvasElement.height);this.canvasElement.onmousemove=function(r){t.onMouseMove&&t.onMouseMove(new i.a(r.pageX-e.x,r.pageY-e.y))},this.canvasElement.onmousedown=function(r){t.onMouseDown&&t.onMouseDown(new i.a(r.pageX-e.x,r.pageY-e.y))}},t.prototype.createScreenQuad=function(){var t=[1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,0,1,1,0,0,1,1,1,1],e=[0,1,2,2,3,0];this._screenQuadVB=new s.a(h.i.Pos3Tex2Col4,4),this._screenQuadIB=new n.a(h.e.Byte,6),this._screenQuadVB.update(t,0),this._screenQuadIB.update(e,0)},t.prototype.getWebGLComparison=function(t){switch(t){case h.d.Never:return a.b.NEVER;case h.d.Less:return a.b.LESS;case h.d.Equal:return a.b.EQUAL;case h.d.LessOrEqual:return a.b.LEQUAL;case h.d.Greater:return a.b.GREATER;case h.d.NotEqual:return a.b.NOTEQUAL;case h.d.GreaterOrEqual:return a.b.GEQUAL;case h.d.Always:return a.b.ALWAYS}},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var i=r(6),n=r(4),o=function(){function t(){this.viewProjection=new i.a,this.model=new i.a,this.modelViewProjection=new i.a,this.color=new n.a(1,1,1,1),this.calculateMVP()}return t.prototype.calculateMVP=function(){this.modelViewProjection=this.viewProjection.multiplyMat(this.model)},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var i=r(21),n=r(22),o=function(){function t(){}return t.prototype.load=function(t){return new Promise(function(e,r){var o=new n.a,s=new Image;s.onload=function(n){o.loadFromImage(s),console.log("Texture '"+t[0]+"' loaded, width: "+s.width+", height: "+s.height),i.a.getTextFromUrl(t[1]).then(function(t){o.loadRegionInfo(t),e(o)}).catch(function(t){return r(t)})},s.onerror=function(t){return r(t)},s.src=t[0]})},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var i=function(){function t(){}return t.getElementDataOrEmpty=function(t){var e=document.getElementById(t);return e?e.innerHTML:""},t.getTextFromUrl=function(t){return new Promise(function(e,r){var i=new XMLHttpRequest;i.open("get",t),i.onload=function(){i.status>=200&&i.status<300?e(i.response):r({status:i.status,statusText:i.statusText})},i.onerror=function(){r({status:i.status,statusText:i.statusText})},i.send()})},t.getJSONFromUrl=function(t){return this.getTextFromUrl(t).then(function(t){return JSON.parse(t)})},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var i=r(23),n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),o=(function(){function t(){}}(),/(.*?)\t(\d*?)\t(\d*?)\t(\d*?)\t(\d*?)\t(\d*?)\t(\d*?)\t(\d*?)\t(\d*?)\t([r]?)/),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._regions=[],e}return n(e,t),e.prototype.free=function(){t.prototype.free.call(this)},e.prototype.getRegion=function(t){var e=this._regions.filter(function(e){return e.name===t});return 0===e.length?console.error("Can't find region '"+t+"'"):e.length>1&&console.error("Too many regions ("+e.length+") with name '"+t+"'"),e[0]},e.prototype.loadRegionInfo=function(t){for(var e=t.split("\n").slice(1),r=0,i=e;r<i.length;r++){var n=i[r];if(n&&0!==n.length){var s=o.exec(n);s?this._regions.push({texture:this,name:s[1],tx:parseInt(s[2])/this.width,ty:parseInt(s[3])/this.height,tw:parseInt(s[4])/this.width,th:parseInt(s[5])/this.height,rotated:s.length>10&&"r"===s[10]}):console.error("TextureAtlas - can't parse line '"+n+"'")}}console.log(this._regions)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var i=r(2),n=r(0),o=r(1),s=function(){function t(){if(this.width=1,this.height=1,this.texture=n.b.createTexture(),null===this.texture)return void console.log("Texture create failed - null returned");n.b.bindTexture(n.b.TEXTURE_2D,this.texture);var t=new Uint8Array([0,0,255,255]);n.b.texImage2D(n.b.TEXTURE_2D,0,n.b.RGBA,1,1,0,n.b.RGBA,n.b.UNSIGNED_BYTE,t)}return t.unbind=function(){n.c.setTexture(null,0)},t.prototype.free=function(){n.b.deleteTexture(this.texture)},t.prototype.setWrap=function(t,e){n.b.bindTexture(n.b.TEXTURE_2D,this.texture),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_WRAP_S,this.getWebGLWrap(t)),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_WRAP_T,this.getWebGLWrap(e)),n.b.bindTexture(n.b.TEXTURE_2D,null)},t.prototype.setFilter=function(t){n.b.bindTexture(n.b.TEXTURE_2D,this.texture),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_MIN_FILTER,this.getWebGLFilter(t)),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_MAG_FILTER,this.getWebGLFilter(t)),n.b.bindTexture(n.b.TEXTURE_2D,null)},t.prototype.bind=function(t){void 0===t&&(t=0),n.c.setTexture(this,t)},t.prototype.loadFromImage=function(t){this.width=t.width,this.height=t.height,n.b.bindTexture(n.b.TEXTURE_2D,this.texture),n.b.texImage2D(n.b.TEXTURE_2D,0,n.b.RGBA,n.b.RGBA,n.b.UNSIGNED_BYTE,t),Object(i.c)(t.width)&&Object(i.c)(t.height)?n.b.generateMipmap(n.b.TEXTURE_2D):(n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_WRAP_S,n.b.CLAMP_TO_EDGE),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_WRAP_T,n.b.CLAMP_TO_EDGE),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_MIN_FILTER,n.b.LINEAR),n.b.texParameteri(n.b.TEXTURE_2D,n.b.TEXTURE_MAG_FILTER,n.b.LINEAR)),this.trySetAnisotropic(16)},t.prototype.getWebGLWrap=function(t){switch(t){case o.g.Repeat:return n.b.REPEAT;case o.g.MirrorRepeat:return n.b.MIRRORED_REPEAT;default:case o.g.ClampToEdge:return n.b.CLAMP_TO_EDGE}},t.prototype.getWebGLFilter=function(t){switch(t){case o.f.Linear:return n.b.LINEAR;default:case o.f.Nearest:return n.b.NEAREST}},t.prototype.trySetAnisotropic=function(t){var e=n.b.getExtension("EXT_texture_filter_anisotropic")||n.b.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.b.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(e){var r=n.b.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),i=Math.min(t,r);n.b.texParameterf(n.b.TEXTURE_2D,e.TEXTURE_MAX_ANISOTROPY_EXT,i)}},t}()}]);